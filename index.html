
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>@Lenciel</title>
  <meta name="author" content="Lenciel Li">

  
  <meta name="description" content="一个朋友最近跟我说，想去把伤口结痂留下的疤痕用液氮处理一下。 这是我第一次听说除开激光这种“极热”之外，还可以在人的身上用这种“极冻”的方式祛疤。 不过，虽然是听起来非常激烈的方式，大概多少也得吃点儿苦头，但能顺利把身上的疤去掉，总是好的。 相比之下，心头的疤就没有那么容易弄掉了：8月28日， &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://lenciel.cn/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/stylesheets/data-table.css" media="screen, projection" rel="stylesheet" type="text/css" />
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="http://feeds.feedburner.com/github/lenciel" rel="alternate" title="@Lenciel" type="application/atom+xml">
  <!-- Facebook Open Graph
     Facebook Debugger: https://developers.facebook.com/tools/debug -->

<meta property="og:type" content="article" />
<meta property="og:url" content="http://lenciel.cn/" />
<meta property="og:description" content="一个朋友最近跟我说，想去把伤口结痂留下的疤痕用液氮处理一下。 这是我第一次听说除开激光这种“极热”之外，还可以在人的身上用这种“极冻”的方式祛疤。 不过，虽然是听起来非常激烈的方式，大概多少也得吃点儿苦头，但能顺利把身上的疤去掉，总是好的。 相比之下，心头的疤就没有那么容易弄掉了：8月28日， &hellip;" />

<meta property="og:site_name" content="http://lenciel.cn" />
<meta property="article:author" content="http://lenciel.cn">



<meta itemprop="description" content="一个朋友最近跟我说，想去把伤口结痂留下的疤痕用液氮处理一下。 这是我第一次听说除开激光这种“极热”之外，还可以在人的身上用这种“极冻”的方式祛疤。 不过，虽然是听起来非常激烈的方式，大概多少也得吃点儿苦头，但能顺利把身上的疤去掉，总是好的。 相比之下，心头的疤就没有那么容易弄掉了：8月28日， &hellip;" />

<!-- Combine multiple fonts into one request -->
<!--<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic|Patua+One|Yanone+Kaffeesatz" rel="stylesheet" type="text/css">-->
<link href="http://fonts.useso.com/css?family=PT+Sans:regular,italic,bold,bolditalic|Patua+One|Yanone+Kaffeesatz" rel="stylesheet" type="text/css">
<!--<style>
  @font-face {
  font-family: 'PT Sans';
  font-style: normal;
  font-weight: 400;
  src: local('PT Sans'), local('PTSans-Regular'), url('http://lenciel.cn/fonts/PTSans-Regular.woff') format('woff');
}
@font-face {
  font-family: 'PT Sans';
  font-style: normal;
  font-weight: 700;
  src: local('PT Sans Bold'), local('PTSans-Bold'), url('http://lenciel.cn/fonts/PTSans-Bold.woff') format('woff');
}
@font-face {
  font-family: 'PT Sans';
  font-style: italic;
  font-weight: 400;
  src: local('PT Sans Italic'), local('PTSans-Italic'), url('http://lenciel.cn/fonts/PTSans-Italic.woff') format('woff');
}
@font-face {
  font-family: 'PT Sans';
  font-style: italic;
  font-weight: 700;
  src: local('PT Sans Bold Italic'), local('PTSans-BoldItalic'), url('http://lenciel.cn/fonts/PTSans-BoldItalic.woff') format('woff');
}
@font-face {
  font-family: 'Patua One';
  font-style: normal;
  font-weight: 400;
  src: local('Patua One'), local('PatuaOne-Regular'), url('http://lenciel.cn/fonts/PatuaOne-Regular.woff') format('woff');
}
@font-face {
  font-family: 'Yanone Kaffeesatz';
  font-style: normal;
  font-weight: 400;
  src: local('Yanone Kaffeesatz Regular'), local('YanoneKaffeesatz-Regular'), url('http://lenciel.cn/fonts/YanoneKaffeesatz-Regular.woff') format('woff');
}
</style>-->
<!-- jQuery -->
<!--<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>-->
<script src="//upcdn.b0.upaiyun.com/libs/jquery/jquery-1.7.2.min.js">

  <script type="text/javascript">
    var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
    document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F2f0a0a00f439ab96a80a199638ef8594' type='text/javascript'%3E%3C/script%3E"));
</script>


  
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-175991-3', 'lenciel.cn');
  ga('send', 'pageview');

</script>


</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">@Lenciel</a></h1>
  
    <h2>Thoughts and Rants.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="http://feeds.feedburner.com/github/lenciel" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:lenciel.cn" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/"><i class="icon-home"></i>Home</a></li>
  <li><a href="/blog/archives"><i class="icon-book-alt"></i>Archives</a><span class="divider"></span></li>
  <li><a href="/about"><i class="icon-user"></i>About</a><span class="divider"></span></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/09/everybody-hurts/">疤</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-09-01T03:38:50+08:00" pubdate data-updated="true">2014/09/01 03:38</time>
        
         | <a href="/2014/09/everybody-hurts/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="/downloads/images/2014_09/choose_who_to_let_in.jpg" alt="careful to choose" title="Be careful to choose..." /></p>

<p>一个朋友最近跟我说，想去把伤口结痂留下的疤痕用液氮处理一下。</p>

<p>这是我第一次听说除开激光这种“极热”之外，还可以在人的身上用这种“极冻”的方式祛疤。</p>

<p>不过，虽然是听起来非常激烈的方式，大概多少也得吃点儿苦头，但能顺利把身上的疤去掉，总是好的。</p>

<p>相比之下，心头的疤就没有那么容易弄掉了：8月28日，孙仲旭老师因为抑郁症自杀辞世的新闻曝出，着实让我心里面咯噔了一下。</p>

<p>这离Robin Williams抑郁而终不过两个多星期。</p>

<p>《1984》、《动物庄园》、《麦田里的守望者》和耶茨的很多小说，其实之前就看过。但后来因为看了孙仲旭老师翻译的《麦田里的守望者》，就把他其他的译作都翻来看了。</p>

<p>现在想来，从他翻译目标的选择来看，本身就是一个很不快乐的人吧。</p>

<p>当然，这很正常。</p>

<p>人虽然从出生开始，都无非是走在通向死亡的道路之上，但每个人经历的过程和心中的念想却大不相同。</p>

<p>有的人很幸运，出生在和谐的家庭，从小就完整地见证过快乐是什么，长大后也顺风顺水，对人生有自己明确的诉求。</p>

<p>而有的人，只见到过碎片一样的生活，自己从来不明白自己活着是需要什么，又能给别人提供什么。</p>

<p>不但如此，还会对那些把幸福或者是快乐挂在嘴边的人呲之以鼻：因为从心底质疑它们是否真的存在。</p>

<p>正是有《麦田里的守望者》这样的小说，正是有Robin Williams这样的演员，正是有孙仲旭老师这样的译者，才让后面这种人明白，自己不是什么奇奇怪怪的东西：原来还有很多人都这样活着，或者是这样活过。</p>

<p>而偏偏也是他们选择了自戕，仿佛在提醒大家：你看，就算知道有这么多人这样活着，我也不知道如何是好。</p>

<p>我想他们不是没有放胆让那些温暖的人走进自己内心，也感受过幸福和快乐。但要习得<a href="http://lenciel.cn/2014/04/rip-marquez/">孤独与爱</a>的要义实在是太难。更何况，抑郁并不仅仅是心理上的问题而已。</p>

<p>最后，摘一段献给孙仲旭老师，Wish you rest in peace：</p>

<blockquote><p>“我知道他死了！你以为我不知道？但是我仍然可以喜欢他，行吗？就因为这人死了，你不可能马上不再喜欢他了，岂有此理 —— 特别当这个人比你认识的活人要好上一千倍时。”</p><footer><strong>《麦田里的守望者》</strong></footer></blockquote>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/08/how-complex-your-python-project-is/">How Complex Your Python Project Is?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-31T21:04:47+08:00" pubdate data-updated="true">2014/08/31 21:04</time>
        
         | <a href="/2014/08/how-complex-your-python-project-is/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>最近诸事不顺，却也理所应当。</p>

<p>晚间时段迷上写字和画画，大概是因为之前看<a href="http://www.imdb.com/title/tt0460740/">《Cashback》</a>印象太深刻，觉得这些是美好遗失前力挽狂澜的技艺。</p>

<p>除开纸上涂鸦，还用机器画了不少鸡零狗碎的东西：我想用python画点儿T恤图案，印出来送给大家，给大伙儿同时也给自己打打气。</p>

<p>一开始看中了基于<a href="http://www.graphviz.org/">Graphviz</a>的<a href="http://furius.ca/snakefood/">Snakefood</a>。</p>

<p>最开始接触Graphviz是因为<a href="https://github.com/django-extensions/django-extensions">django-extensions</a>项目用它来画django model的<a href="https://code.djangoproject.com/wiki/DjangoGraphviz">关系图</a>。我们用它冒充ER图，拿去跟那些喜欢看文档但其实又不专业的官僚客户们交差。</p>

<p>Snakefood更进一步，通过分析你的代码依赖，从而得出你代码的“复杂度”。</p>

<p>“复杂度”其实是用“代码行数”衡量码农工作效力被普遍吐槽之后，大公司发明出来折腾工程师的诸多metrics里面还算有点儿用的一个：至少你可以让要接手的人看看这项目大概是个什么规模，以及，大概要挠破几寸头皮才能看懂。</p>

<p>当然，Snakefood这种基于文件依赖的复杂度分析其实不算特别靠谱，这可不是什么<a href="https://en.wikipedia.org/wiki/Cyclomatic_complexity">Cyclomatic complexity</a>，更像是开飞机的时候边排查“事故征兆”边驾驶的辅助工具。作者自己是这么说的：</p>

<blockquote><p>Producing pretty graphs is fun, but I found the most leverage of it when I try to make my code simpler, I generate the graph and inspect unexpected dependencies and try to refactor my code to simply the dependency graph as much as possible.</p><footer><strong>Martin Blais</strong></footer></blockquote>

<p>下面是本座心目中永远的”优雅Python代码第一名”<a href="http://docs.python-requests.org/en/latest/">Requests</a>的分析结果：</p>

<p><img src="/downloads/images/2014_08/requests.png" alt="requests" title="requests dependencies" /></p>

<p>再来看看<a href="https://github.com/django/django">Django</a>的最新版分析结果：</p>

<p><img src="/downloads/images/2014_08/django.png" alt="django" title="django dependencies" /></p>

<p>下面是本座最近撸完的一个项目，印到衣服上感觉还好吧：
<img src="/downloads/images/2014_08/yawp.png" alt="yawp" title="yawp dependencies" /></p>

<h2 id="section">结论</h2>

<p>首先，本座挺喜欢Snakefood那种Unix范儿的：所有的命令都可以给其他命令来一管，比如：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line">sfood ./src | sfood-graph -p | dot -Tps | pstopdf -i -o ./1.pdf
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>其次，本座开始计划是给每个人生成一个他们自己写的模块的依赖图，印到衣服上让大家自己穿。但试了之前几个项目之后，Hmmmm…有的同学大概是不会愿意的吧…</p>

<p>最后，T恤计划也没这么就打住：后来又发现了<a href="http://nodebox.net/">nodebox</a>这种真正是拿来搞艺术的玩意儿，于是要生成一点儿敢往自己胸口放的东西变得方便多了，过两天如果公司没有倒闭，就把东西放出来让大家看看。</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/08/but-does-it-flow/">突然事件</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-21T03:54:13+08:00" pubdate data-updated="true">2014/08/21 03:54</time>
        
         | <a href="/2014/08/but-does-it-flow/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><img src="/downloads/images/2014_08/just_let_it_go.jpg" alt="Vhost threshold" title="Don't touch me..." /></p>

<p>葛明走了之后，我们去火葬场送他。</p>

<p>他在关好门窗的卧室里点燃了一盆木炭，静悄悄走掉了。</p>

<p>最先发现他的是跟他住一起的他母亲。她说，一圈木炭排在火盆里，大头向上，小头向下，整整齐齐。另外，他还专门喝了安眠药，所以没有一般烧炭者因为气促造成的痉挛表情。</p>

<p>这就是他的风格，做什么都计划详实，控制精准，旁人既无法预知，更无法阻挡。</p>

<p>“他不但表情很安详，而且碳氧血红蛋白让他全身都变成了樱桃红色，看起来就像个刚出生那天一样。”</p>

<p>“阿姨，你……”，我听到他妈妈这样说的时候有些不知道该怎么接话。</p>

<p>“别怕，我没疯”，她抹了一把眼泪，“只不过阿姨我退休之前是个法医。”</p>

<p>那天的确有很多眼泪，大家说的最多是，这太突然。</p>

<p>但我觉得不奇怪。的确，葛明是我们中间最幽默的人。不过，活到我这把年纪，已经明白那些让别人发笑的人，不过是把这技能当成保护自己内心世界的硬壳而已。和大多数动不动就要哭死在你面前的朋友相比，他们心门紧锁，难以真正亲近。</p>

<p>即便是像我们这样的关系，他也只说起过几次他的烦恼。</p>

<p>一次是他请我去他家吃饭，说想让我帮忙。</p>

<p>“我在找方便好用的热敷袋。要求很简单，一个人操作起来要很方便，什么部位用起来都很方便，什么时候想用热起来要很方便，还有，不要太丑”。</p>

<p>“最后一个要求表明，你是要送人吧？”</p>

<p>他只是笑，带我去看书房里面满屋子奇形怪状的物件。</p>

<p>“别人都说淘宝上什么都有得卖，但是我买回来试了好多，都没有特别满意的。”</p>

<p>我看了看，基本都还是进口货。</p>

<p>“如果说有热敷袋里的战斗机，那我好像就身处一个军事机场了，所以感觉帮不上什么忙了。”</p>

<p>“我已经大概决定哪几个比较好了，我是要你帮忙把我不要的带走几个。”</p>

<p>后来我听说，葛明给我们这帮人每人送了几个热敷袋。我们现在也不知道，他满意的那些究竟和我们手上的这些有什么不一样。</p>

<p>还有一次，是他叫我出去喝酒。喝到一半，他递给我他的手机，看一个什么“女神男神体重表”。</p>

<p>“你看，我是男神。”</p>

<p>“这谁给你发的？”</p>

<p>“是给我发的最后一条消息。”</p>

<p>“那你为什么不回呢？这不是一个很不错的开始聊天的话题吗？”</p>

<p>“因为是之前答应要发给我这个，但发之前，就说了以后不要再联系了。”</p>

<p>“那就不回了？我以为你的风格是永远最后挂电话，永远回最后一条的。”</p>

<p>“嗯，不回是因为会希望一直没有收到过这个。”</p>

<p>“为什么呢？”</p>

<p>“因为一旦收到，就会有’我答应你的事情已经办完了从此我们就没有关系了’的感觉冒出来，就好像我自己站在被封起来的纸箱里面，看到胶条把最后那点儿缝隙盖起来了一样。所以不知道怎么回，也宁愿一直没有收到。”</p>

<p>我最后一次见到他，是在商场碰巧遇见他在挑榨汁机。他拿着说明书，对导购小姐说：</p>

<p>“你看，上面写着：使用后立即清洁，就容易清洁。”</p>

<p>“是的，先生。”</p>

<p>“然后后面几页，它又写着：榨汁后应立即饮用。如果汁液在空气中暴露一段时间，就会变味并失去营养价值。”</p>

<p>“是的，先生。”</p>

<p>“那我每次榨完汁，究竟应该立即去清洗，还是应该立即去饮用果汁呢？”</p>

<p>他问完这个问题，我和导购小姐都笑了。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/2014/08/django-1-dot-7-migrations-part-2/">Data Migration in Django 1.7 (2)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-11T03:59:47+08:00" pubdate data-updated="true">2014/08/11 03:59</time>
        
         | <a href="/2014/08/django-1-dot-7-migrations-part-2/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>在应用开发的过程中，我们会遇到migration主要分为：</p>

<ol>
  <li>Schema Migrations：数据库schema的变化，也就是我们前面<a href="http://lenciel.cn/2014/08/django-1-dot-7-migrations/">讨论的内容</a></li>
  <li>Data Migrations：数据的变化，比如需要批量变更数据或者备份在其他地方的历史数据</li>
</ol>

<p>第二种是没法敲几条命令让Django自动帮你完成其他的事情的，而是需要手动使用<code>RunPython</code>，这里具体说一下做法。</p>

<p>还是以之前的那个项目来作为例子，我们首先创建一个migration file：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
</pre></td><td class="code"><pre><code class="bash"><span class="line"><span class="nv">$ </span>python manage.py makemigrations --empty ts_data
</span><span class="line">
</span><span class="line">Migrations <span class="k">for </span>ts_data:
</span><span class="line">  0003_auto_20140811_0110.py:
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>它的内容如下：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="c"># -*- coding: utf-8 -*-</span>
</span><span class="line"><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">unicode_literals</span>
</span><span class="line">
</span><span class="line"><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">migrations</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">class</span> <span class="nc">Migration</span><span class="p">(</span><span class="n">migrations</span><span class="o">.</span><span class="n">Migration</span><span class="p">):</span>
</span><span class="line">
</span><span class="line">    <span class="n">dependencies</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="line">        <span class="p">(</span><span class="s">&#39;ts_data&#39;</span><span class="p">,</span> <span class="s">&#39;0002_auto_20140805_1525&#39;</span><span class="p">),</span>
</span><span class="line">    <span class="p">]</span>
</span><span class="line">
</span><span class="line">    <span class="n">operations</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="line">    <span class="p">]</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>我们在里面加入一个<code>RunPython</code>的部分，来导入数据：</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
<span class="line-number">2</span>
<span class="line-number">3</span>
<span class="line-number">4</span>
<span class="line-number">5</span>
<span class="line-number">6</span>
<span class="line-number">7</span>
<span class="line-number">8</span>
<span class="line-number">9</span>
<span class="line-number">10</span>
<span class="line-number">11</span>
<span class="line-number">12</span>
<span class="line-number">13</span>
<span class="line-number">14</span>
<span class="line-number">15</span>
<span class="line-number">16</span>
<span class="line-number">17</span>
<span class="line-number">18</span>
<span class="line-number">19</span>
<span class="line-number">20</span>
<span class="line-number">21</span>
<span class="line-number">22</span>
<span class="line-number">23</span>
</pre></td><td class="code"><pre><code class="python"><span class="line"><span class="c"># -*- coding: utf-8 -*-</span>
</span><span class="line"><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">unicode_literals</span>
</span><span class="line">
</span><span class="line"><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">migrations</span>
</span><span class="line"><span class="kn">from</span> <span class="nn">ts_data.models</span> <span class="kn">import</span> <span class="n">PingPongPrice</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="n">apps</span><span class="p">,</span> <span class="n">schema_editor</span><span class="p">):</span>
</span><span class="line">    <span class="n">PingPongPrice</span><span class="p">(</span><span class="n">date</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span><span class="mo">07</span><span class="p">,</span><span class="mi">29</span><span class="p">),</span>
</span><span class="line">         <span class="n">price</span><span class="o">=</span><span class="mf">12.00</span><span class="p">,</span>
</span><span class="line">         <span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span class="line">    <span class="n">PingPongPrice</span><span class="p">(</span><span class="n">date</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="mi">2014</span><span class="p">,</span><span class="mo">01</span><span class="p">,</span><span class="mi">29</span><span class="p">),</span>
</span><span class="line">         <span class="n">price</span><span class="o">=</span><span class="mf">8.00</span><span class="p">,</span>
</span><span class="line">         <span class="p">)</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</span><span class="line">
</span><span class="line">
</span><span class="line"><span class="k">class</span> <span class="nc">Migration</span><span class="p">(</span><span class="n">migrations</span><span class="o">.</span><span class="n">Migration</span><span class="p">):</span>
</span><span class="line">
</span><span class="line">    <span class="n">dependencies</span> <span class="o">=</span> <span class="p">[</span>
</span><span class="line">        <span class="p">(</span><span class="s">&#39;ts_data&#39;</span><span class="p">,</span> <span class="s">&#39;0002_auto_20140805_1525&#39;</span><span class="p">),</span>
</span><span class="line">    <span class="p">]</span>
</span><span class="line">
</span><span class="line">    <span class="n">operations</span> <span class="o">=</span> <span class="p">[</span><span class="n">migrations</span><span class="o">.</span><span class="n">RunPython</span><span class="p">(</span><span class="n">load_data</span><span class="p">)]</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>如果你觉得：咦，这样导入数据不是有点儿像用<code>syncdb</code>然后导入<code>fixture</code>么？的确，从效果上它们是一样的，个人觉得，对于测试环境我们可以继续使用fixture来保存mock的测试数据，然后使用<code>loaddata</code>命令手动加载测试数据。对生产环境使用migration来导入数据更好，和使用<code>loaddata</code>命令来导入fixture相比，它不需要手动操作，并且由于是通过<code>RunPython</code>来进行，实际上可以对数据进行各种需要的处理。</p>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    
  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
Blog theme: <a href="https://github.com/lenciel/octopress-theme-lenciel">Octopress-Lenciel 0.1</a>
<span class="theme-version">Copyright &copy; 2014 - Lenciel Li</span>
  <section class="contruction-wrap">
    <div class="contruction"></div>
  </section>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'lencielgithub';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>










</body>
</html>
